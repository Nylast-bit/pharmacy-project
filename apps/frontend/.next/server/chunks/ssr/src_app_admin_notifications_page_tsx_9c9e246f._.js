module.exports=[83921,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(2759),e=a.i(9941),f=a.i(60246),g=a.i(87532),h=a.i(13749),i=a.i(50522),j=a.i(92258),k=a.i(41675),l=a.i(92759),m=a.i(70106);let n=(0,m.default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var o=a.i(67453);let p=(0,m.default)("refresh-ccw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]),q=(0,m.default)("mail-plus",[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8",key:"12jkf8"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"M19 16v6",key:"tddt3s"}],["path",{d:"M16 19h6",key:"xwg31i"}]]);var r=a.i(33508),s=a.i(4720);let t=(0,m.default)("clipboard-paste",[["path",{d:"M11 14h10",key:"1w8e9d"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v1.344",key:"1e62lh"}],["path",{d:"m17 18 4-4-4-4",key:"z2g111"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 1.793-1.113",key:"bjbb7m"}],["rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",key:"ublpy"}]]);a.s(["default",0,function(){let[a,m]=(0,c.useState)([]),[u,v]=(0,c.useState)(!0),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)({key:"id_cliente",direction:null}),[A,B]=(0,c.useState)(1),[C,D]=(0,c.useState)(new Set),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(""),[Q,R]=(0,c.useState)([]),[S,T]=(0,c.useState)(null),[U,V]=(0,c.useState)(""),W=async()=>{v(!0);try{let a=await fetch(`${d.API_BASE_URL}/api/customers/`),b=await a.json();m(b)}catch(a){console.error(a),L({type:"error",text:"Error loading customers."})}finally{v(!1)}};(0,c.useEffect)(()=>{W()},[]);let X=(0,c.useMemo)(()=>a.filter(a=>{let b=w.toLowerCase(),c=a.nombre?.toLowerCase()||"",d=a.correo?.toLowerCase()||"";return c.includes(b)||d.includes(b)||a.id_cliente.toString().includes(b)}),[a,w]),Y=(0,c.useMemo)(()=>y.direction?[...X].sort((a,b)=>{let c=y.key,d=a[c],e=b[c];if("fecha_ultima_promocion"===c){if(null===d)return 1;if(null===e)return -1}return("string"==typeof d&&(d=d.toLowerCase()),"string"==typeof e&&(e=e.toLowerCase()),d<e)?"asc"===y.direction?-1:1:d>e?"asc"===y.direction?1:-1:0}):X,[X,y]),Z=Math.ceil(Y.length/10),$=Y.slice((A-1)*10,10*A),_=a=>{let b=Array.from(new Set(a.split(/[\n\s,;]+/).map(a=>a.trim()).filter(a=>a.length>0&&a.includes("@"))));R(b),b.length>100?T(`Warning: You have added ${b.length} emails. This is more than 100.`):T(null)},aa=async()=>{if(!E||!G){L({type:"error",text:"Subject and Email Body are required."}),N(!1);return}0===Q.length?T("No valid emails were found to send to."):(Q.length,await ab("send-to-emails-list",{emails:Q,subject:E,htmlBody:G},`Email sent to ${Q.length} custom emails.`),N(!1),R([]),P(""),T(null))},ab=async(a,b,c)=>{J(!0),L(null);try{let e=await fetch(`${d.API_BASE_URL}/api/email/${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),f=await e.json();if(!e.ok)throw Error(f.message||"API Error");L({type:"success",text:f.message||c}),D(new Set),F(""),H(""),W()}catch(a){L({type:"error",text:a instanceof Error?a.message:"Unknown error"})}finally{J(!1)}},ac=async()=>{await ab("reset-notifications",{},"Notifications have been reset.")};return u?(0,b.jsxs)("div",{className:"flex flex-col justify-center items-center h-screen",children:[(0,b.jsx)("div",{className:"w-16 h-16 border-4 border-[#00a2b9] border-t-transparent rounded-full animate-spin mb-4"}),(0,b.jsx)("p",{className:"text-gray-600 font-medium",children:"Loading customers..."})]}):(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-4 md:p-8",children:[(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsx)("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-6",children:(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"text-3xl font-bold bg-gradient-to-r from-[#00a2b9] to-[#00c8d7] bg-clip-text text-transparent flex items-center gap-3",children:[(0,b.jsx)(l.Send,{className:"text-[#00a2b9]",size:32}),"Send Promotions"]}),(0,b.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:"Select customers and send promotional emails"})]}),(0,b.jsx)("div",{className:"flex flex-col sm:flex-row gap-3 w-full lg:w-auto",children:(0,b.jsxs)("div",{className:"relative flex-1 lg:w-72",children:[(0,b.jsx)(g.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),(0,b.jsx)("input",{className:"w-full border-2 border-gray-200 rounded-xl pl-10 pr-4 py-3 focus:ring-4 focus:ring-[#00a2b9]/10 focus:border-[#00a2b9] focus:outline-none transition-all",placeholder:"Search by name, email...",value:w,onChange:a=>x(a.target.value)})]})})]})}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-6",children:[(0,b.jsxs)("form",{onSubmit:a=>{(a.preventDefault(),0===C.size)?L({type:"error",text:"You haven't selected any customers."}):ab("send-to-list",{clientIds:Array.from(C),subject:E,htmlBody:G},"Email sent to selected customers.")},className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),(0,b.jsx)("input",{type:"text",id:"subject",value:E,onChange:a=>F(a.target.value),className:"w-full border-2 border-gray-200 rounded-xl px-4 py-3 focus:ring-4 focus:ring-[#00a2b9]/10 focus:border-[#00a2b9] focus:outline-none transition-all",placeholder:"Weekend Promotion!",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"htmlBody",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Body (HTML)"}),(0,b.jsx)("textarea",{id:"htmlBody",rows:6,value:G,onChange:a=>H(a.target.value),className:"w-full border-2 border-gray-200 rounded-xl px-4 py-3 focus:ring-4 focus:ring-[#00a2b9]/10 focus:border-[#00a2b9] focus:outline-none transition-all",placeholder:"<h1>Hi!</h1><p>We have a 20% discount...</p>",required:!0})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-3 pt-2",children:[(0,b.jsxs)("button",{type:"submit",disabled:I||0===C.size,className:"flex items-center gap-2 px-4 py-2 bg-[#00a2b9] text-white rounded-xl shadow-md hover:bg-[#008899] transition-all disabled:bg-gray-400 disabled:cursor-not-allowed",children:[(0,b.jsx)(l.Send,{size:18}),I?"Sending...":`Send to (${C.size}) selected`]}),(0,b.jsx)("button",{type:"button",onClick:()=>{E&&G?ab("send-to-latest",{subject:E,htmlBody:G},"Email sent to the 100 most recent customers."):L({type:"error",text:"Subject and Email Body are required."})},disabled:I,className:"flex items-center gap-2 px-4 py-2 bg-gray-700 text-white rounded-xl shadow-md hover:bg-gray-800 transition-all disabled:bg-gray-400",children:I?"Sending...":"Send to 100 Most Recent"}),(0,b.jsx)("button",{type:"button",onClick:()=>N(!0),disabled:I,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-xl shadow-md hover:bg-blue-700 transition-all disabled:bg-gray-400",children:"                Upload Email List               "}),(0,b.jsxs)("button",{type:"button",onClick:ac,disabled:I,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-xl shadow-md hover:bg-red-700 transition-all disabled:bg-gray-400",children:[(0,b.jsx)(p,{size:18}),"Reset Dates"]})]})]}),K&&(0,b.jsx)("div",{className:`mt-4 p-4 rounded-xl text-sm ${"success"===K.type?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:K.text})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-sm",children:[(0,b.jsx)("thead",{className:"bg-gradient-to-r from-[#00a2b9] to-[#00c8d7] text-white",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"p-4",children:(0,b.jsx)("input",{type:"checkbox",className:"rounded border-gray-300 text-[#00a2b9] focus:ring-[#00a2b9] focus:ring-offset-0",onChange:a=>{a.target.checked?D(new Set(X.filter(a=>a.correo).map(a=>a.id_cliente))):D(new Set)},checked:X.length>0&&C.size===X.filter(a=>a.correo).length})}),[{key:"id_cliente",label:"ID"},{key:"nombre",label:"Name"},{key:"correo",label:"Email"},{key:"fecha_ultima_promocion",label:"Last Promotion"}].map(a=>(0,b.jsx)("th",{onClick:()=>{var b;return b=a.key,void z(a=>{if(a.key===b){if("asc"===a.direction)return{key:b,direction:"desc"};if("desc"===a.direction)return{key:b,direction:null}}return{key:b,direction:"asc"}})},className:"px-6 py-4 text-left cursor-pointer select-none hover:bg-white/10 transition-colors",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 font-semibold",children:[a.label,(0,b.jsx)(e.ArrowUpDown,{size:16,className:"opacity-70"})]})},a.key))]})}),(0,b.jsx)("tbody",{className:"divide-y divide-gray-200",children:0===$.length?(0,b.jsx)("tr",{children:(0,b.jsxs)("td",{colSpan:5,className:"px-6 py-12 text-center",children:[(0,b.jsx)(f.Users,{className:"mx-auto mb-3 text-gray-300",size:48}),(0,b.jsx)("p",{className:"text-gray-500 font-medium",children:"No customers found"}),(0,b.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:"Try adjusting your search"})]})}):$.map(a=>{var c;return(0,b.jsxs)("tr",{className:`transition-colors ${C.has(a.id_cliente)?"bg-[#00a2b9]/10":"hover:bg-gray-50"}`,children:[(0,b.jsx)("td",{className:"p-4",children:(0,b.jsx)("input",{type:"checkbox",className:"rounded border-gray-300 text-[#00a2b9] focus:ring-[#00a2b9] focus:ring-offset-0",checked:C.has(a.id_cliente),onChange:()=>{var b;return b=a.id_cliente,void D(a=>{let c=new Set(a);return c.has(b)?c.delete(b):c.add(b),c})},disabled:!a.correo})}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsxs)("span",{className:"font-semibold text-[#00a2b9]",children:["#",a.id_cliente]})}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsx)("p",{className:"font-medium text-gray-900",children:a.nombre})}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,b.jsx)(j.Mail,{size:14,className:a.correo?"text-gray-400":"text-red-400"}),(0,b.jsx)("span",{className:`text-sm ${!a.correo?"text-red-400 italic":""}`,children:a.correo||"No email"})]})}),(0,b.jsx)("td",{className:"px-6 py-4 text-gray-600",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Calendar,{size:14,className:"text-gray-400"}),(0,b.jsx)("span",{className:"text-sm",children:(c=a.fecha_ultima_promocion)?new Date(c).toLocaleString("en-US"):(0,b.jsx)("span",{className:"text-gray-400 italic",children:"Never"})})]})})]},a.id_cliente)})})]})}),$.length>0&&(0,b.jsxs)("div",{className:"bg-gray-50 px-6 py-4 flex flex-col sm:flex-row justify-between items-center gap-4 border-t",children:[(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:["Showing ",(0,b.jsx)("span",{className:"font-semibold",children:(A-1)*10+1})," to"," ",(0,b.jsx)("span",{className:"font-semibold",children:Math.min(10*A,Y.length)})," ","of ",(0,b.jsx)("span",{className:"font-semibold",children:Y.length})," customers"]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("button",{disabled:1===A,onClick:()=>B(a=>a-1),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ${1===A?"text-gray-400 bg-gray-200 cursor-not-allowed":"text-white bg-[#00a2b9] hover:bg-[#008899] shadow-md hover:shadow-lg"}`,children:[(0,b.jsx)(h.ChevronLeft,{size:16}),"Previous"]}),(0,b.jsxs)("button",{disabled:A===Z||0===Z,onClick:()=>B(a=>a+1),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ${A===Z||0===Z?"text-gray-400 bg-gray-200 cursor-not-allowed":"text-white bg-[#00a2b9] hover:bg-[#008899] shadow-md hover:shadow-lg"}`,children:["Next",(0,b.jsx)(i.ChevronRight,{size:16})]})]})]})]})]}),M&&(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:(0,b.jsxs)("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden animate-in zoom-in-95 duration-200",children:[(0,b.jsxs)("div",{className:"relative bg-gradient-to-r from-[#00a2b9] to-[#00c4d4] p-6",children:[(0,b.jsx)("button",{onClick:()=>N(!1),className:"absolute top-4 right-4 text-white/80 hover:text-white hover:bg-white/20 rounded-full p-2 transition-all duration-200","aria-label":"Close modal",children:(0,b.jsx)(r.X,{size:20})}),(0,b.jsxs)("div",{className:"flex items-center text-white",children:[(0,b.jsx)("div",{className:"bg-white/20 rounded-2xl backdrop-blur-sm",children:(0,b.jsx)(q,{size:28})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-2xl font-bold",children:"Upload Email List"}),(0,b.jsx)("p",{className:"text-white/90 text-sm mt-1",children:"Import your custom recipients"})]})]})]}),(0,b.jsxs)("div",{className:"p-8 space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("label",{htmlFor:"pastedEmails",className:"flex items-center gap-2 text-sm font-semibold text-gray-700",children:[(0,b.jsx)("div",{className:"bg-[#00a2b9]/10 p-1.5 rounded-lg",children:(0,b.jsx)(t,{size:16,className:"text-[#00a2b9]"})}),"Paste Your Emails"]}),(0,b.jsx)("textarea",{id:"pastedEmails",rows:6,value:O,onChange:a=>{P(a.target.value),_(a.target.value)},className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-[#00a2b9] focus:ring-4 focus:ring-[#00a2b9]/10 transition-all duration-200 resize-none text-sm placeholder:text-gray-400",placeholder:"Paste emails separated by commas, spaces, or line breaks  Example: john@company.com, jane@company.com mike@example.com"})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,b.jsx)("div",{className:"w-full border-t border-gray-200"})}),(0,b.jsx)("div",{className:"relative flex justify-center",children:(0,b.jsx)("span",{className:"bg-white px-4 text-sm font-medium text-gray-500",children:"OR"})})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("label",{htmlFor:"fileUpload",className:"flex items-center gap-2 text-sm font-semibold text-gray-700",children:[(0,b.jsx)("div",{className:"bg-[#00a2b9]/10 p-1.5 rounded-lg",children:(0,b.jsx)(s.FileText,{size:16,className:"text-[#00a2b9]"})}),"Upload .txt File"]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{id:"fileUpload",type:"file",accept:".txt",onChange:a=>{let b=a.target.files?.[0];if(!b)return;let c=new FileReader;c.onload=a=>{let b=a.target?.result;P(b),_(b)},c.readAsText(b),a.target.value=""},className:"hidden"}),(0,b.jsxs)("label",{htmlFor:"fileUpload",className:"flex items-center justify-center gap-3 w-full px-6 py-4 border-2 border-dashed border-gray-300 rounded-xl hover:border-[#00a2b9] hover:bg-[#00a2b9]/5 transition-all duration-200 cursor-pointer group",children:[(0,b.jsx)(s.FileText,{size:20,className:"text-gray-400 group-hover:text-[#00a2b9] transition-colors"}),(0,b.jsx)("span",{className:"text-sm text-gray-600 group-hover:text-[#00a2b9] font-medium transition-colors",children:U||"Click to browse or drag & drop"})]})]})]}),(0,b.jsx)("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100/50 rounded-2xl p-5 border border-gray-200",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[Q.length>0?(0,b.jsx)(o.CheckCircle2,{size:20,className:"text-green-500 mt-0.5 flex-shrink-0"}):(0,b.jsx)(n,{size:20,className:"text-gray-400 mt-0.5 flex-shrink-0"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm text-gray-700 font-medium",children:Q.length>0?(0,b.jsxs)(b.Fragment,{children:["Found ",(0,b.jsx)("span",{className:"text-[#00a2b9] font-bold text-lg",children:Q.length})," valid email",1!==Q.length?"s":""]}):"No emails detected yet"}),S&&(0,b.jsx)("div",{className:"mt-3 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:(0,b.jsxs)("p",{className:"text-sm text-amber-800 flex items-start gap-2",children:[(0,b.jsx)(n,{size:16,className:"mt-0.5 flex-shrink-0"}),(0,b.jsx)("span",{children:S})]})})]})]})})]}),(0,b.jsxs)("div",{className:"flex justify-end items-center gap-3 p-6 bg-gray-50 border-t border-gray-200",children:[(0,b.jsx)("button",{type:"button",onClick:()=>N(!1),className:"px-6 py-2.5 text-sm font-semibold text-gray-700 bg-white border-2 border-gray-300 rounded-xl hover:bg-gray-50 hover:border-gray-400 transition-all duration-200",children:"Cancel"}),(0,b.jsxs)("button",{type:"button",onClick:aa,disabled:I||0===Q.length,className:"flex items-center gap-2 px-6 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-[#00a2b9] to-[#00c4d4] rounded-xl hover:shadow-lg hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 disabled:hover:shadow-none transition-all duration-200",children:[(0,b.jsx)(l.Send,{size:18}),I?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"inline-block w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Sending..."]}):`Send to ${Q.length} Email${1!==Q.length?"s":""}`]})]})]})})]})}],83921)}];

//# sourceMappingURL=src_app_admin_notifications_page_tsx_9c9e246f._.js.map